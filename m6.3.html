I have updated the `m6.3.html` file with the new list of students you provided. The `<tbody>` section of the `attendanceTable` now includes these students:

```html
<!DOCTYPE html>
<html lang="th">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>‡∏£‡∏∞‡∏ö‡∏ö‡πÄ‡∏ä‡πá‡∏Ñ‡∏ä‡∏∑‡πà‡∏≠ ‡∏°.6/3</title>
     <link rel="stylesheet" href="class.css">
    <link href="https://fonts.googleapis.com/css2?family=Pormtt&display=swap" rel="stylesheet">
</head>
<body>

<div class="container">
    <div class="header">
        <h2>üè´ ‡∏£‡∏∞‡∏ö‡∏ö‡πÄ‡∏ä‡πá‡∏Ñ‡∏ä‡∏∑‡πà‡∏≠‡∏ô‡∏±‡∏Å‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡∏´‡∏ô‡πâ‡∏≤‡πÄ‡∏™‡∏≤‡∏ò‡∏á‡∏ä‡∏±‡πâ‡∏ô ‡∏°.6/3</h2>
    </div>

    <div class="controls-top">
        <input type="text" id="searchInput" placeholder="üîç ‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤‡∏ä‡∏∑‡πà‡∏≠‡∏ô‡∏±‡∏Å‡πÄ‡∏£‡∏µ‡∏¢‡∏ô...">
        <a href="index.html" class="button back-button">‚ùÆ ‡∏Å‡∏•‡∏±‡∏ö‡∏´‡∏ô‡πâ‡∏≤‡πÅ‡∏£‡∏Å</a>
    </div>

    <div class="table-responsive">
        <table id="attendanceTable">
            <thead>
                <tr>
                    <th>‡∏•‡∏≥‡∏î‡∏±‡∏ö</th>
                    <th>‡∏ä‡∏∑‡πà‡∏≠</th>
                    <th>‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞</th>
                </tr>
            </thead>
            <tbody>
                <tr data-student-id="1">
                    <td>1</td>
                    <td>‡∏ô‡∏≤‡∏¢ ‡∏û‡∏∏‡∏ó‡∏ò‡∏¥‡∏û‡∏á‡∏©‡πå ‡∏™‡∏≤‡∏™‡∏±‡∏ô‡πÄ‡∏ó‡∏µ‡∏¢‡∏∞</td>
                    <td>
                        <div class="status-buttons">
                            <div class="status-option" data-status="‚úÖ ‡∏°‡∏≤">‚úÖ ‡∏°‡∏≤</div>
                            <div class="status-option" data-status="‚ùå ‡∏Ç‡∏≤‡∏î">‚ùå ‡∏Ç‡∏≤‡∏î</div>
                            <div class="status-option" data-status="üìù ‡∏•‡∏≤">üìù ‡∏•‡∏≤</div>
                            <div class="status-option" data-status="‚è∞ ‡∏°‡∏≤‡∏™‡∏≤‡∏¢">‚è∞ ‡∏°‡∏≤‡∏™‡∏≤‡∏¢</div>
                        </div>
                    </td>
                </tr>
                <tr data-student-id="2">
                    <td>2</td>
                    <td>‡∏ô‡∏≤‡∏¢ ‡∏ä‡∏ß‡∏±‡∏•‡∏ß‡∏¥‡∏ó‡∏¢‡πå ‡πÄ‡∏ï‡∏µ‡∏¢‡∏ô‡∏Å‡∏•‡∏≤‡∏á</td>
                    <td>
                        <div class="status-buttons">
                            <div class="status-option" data-status="‚úÖ ‡∏°‡∏≤">‚úÖ ‡∏°‡∏≤</div>
                            <div class="status-option" data-status="‚ùå ‡∏Ç‡∏≤‡∏î">‚ùå ‡∏Ç‡∏≤‡∏î</div>
                            <div class="status-option" data-status="üìù ‡∏•‡∏≤">üìù ‡∏•‡∏≤</div>
                            <div class="status-option" data-status="‚è∞ ‡∏°‡∏≤‡∏™‡∏≤‡∏¢">‚è∞ ‡∏°‡∏≤‡∏™‡∏≤‡∏¢</div>
                        </div>
                    </td>
                </tr>
                <tr data-student-id="3">
                    <td>3</td>
                    <td>‡∏ô‡∏≤‡∏¢ ‡∏õ‡∏è‡∏¥‡∏û‡∏• ‡πÄ‡∏™‡∏£‡∏¥‡∏ê‡∏®‡∏£‡∏µ</td>
                    <td>
                        <div class="status-buttons">
                            <div class="status-option" data-status="‚úÖ ‡∏°‡∏≤">‚úÖ ‡∏°‡∏≤</div>
                            <div class="status-option" data-status="‚ùå ‡∏Ç‡∏≤‡∏î">‚ùå ‡∏Ç‡∏≤‡∏î</div>
                            <div class="status-option" data-status="üìù ‡∏•‡∏≤">üìù ‡∏•‡∏≤</div>
                            <div class="status-option" data-status="‚è∞ ‡∏°‡∏≤‡∏™‡∏≤‡∏¢">‚è∞ ‡∏°‡∏≤‡∏™‡∏≤‡∏¢</div>
                        </div>
                    </td>
                </tr>
                <tr data-student-id="4">
                    <td>4</td>
                    <td>‡∏ô‡∏≤‡∏¢ ‡∏Ñ‡∏ì‡∏Å‡∏§‡∏©‡∏ì‡πå ‡πÇ‡∏ó‡∏ô‡∏ï‡∏∞‡∏Ç‡∏ö</td>
                    <td>
                        <div class="status-buttons">
                            <div class="status-option" data-status="‚úÖ ‡∏°‡∏≤">‚úÖ ‡∏°‡∏≤</div>
                            <div class="status-option" data-status="‚ùå ‡∏Ç‡∏≤‡∏î">‚ùå ‡∏Ç‡∏≤‡∏î</div>
                            <div class="status-option" data-status="üìù ‡∏•‡∏≤">üìù ‡∏•‡∏≤</div>
                            <div class="status-option" data-status="‚è∞ ‡∏°‡∏≤‡∏™‡∏≤‡∏¢">‚è∞ ‡∏°‡∏≤‡∏™‡∏≤‡∏¢</div>
                        </div>
                    </td>
                </tr>
                <tr data-student-id="5">
                    <td>5</td>
                    <td>‡∏ô‡∏≤‡∏¢ ‡∏ò‡∏£‡∏≤‡πÄ‡∏ó‡∏û ‡∏ò‡∏ô‡∏π‡∏®‡∏£</td>
                    <td>
                        <div class="status-buttons">
                            <div class="status-option" data-status="‚úÖ ‡∏°‡∏≤">‚úÖ ‡∏°‡∏≤</div>
                            <div class="status-option" data-status="‚ùå ‡∏Ç‡∏≤‡∏î">‚ùå ‡∏Ç‡∏≤‡∏î</div>
                            <div class="status-option" data-status="üìù ‡∏•‡∏≤">üìù ‡∏•‡∏≤</div>
                            <div class="status-option" data-status="‚è∞ ‡∏°‡∏≤‡∏™‡∏≤‡∏¢">‚è∞ ‡∏°‡∏≤‡∏™‡∏≤‡∏¢</div>
                        </div>
                    </td>
                </tr>
                <tr data-student-id="6">
                    <td>6</td>
                    <td>‡∏ô‡∏≤‡∏¢ ‡∏ò‡∏ô‡∏≤‡∏ß‡∏∏‡∏í‡∏¥ ‡∏û‡∏∏‡πà‡∏°‡∏à‡∏±‡∏ô‡∏ó‡∏£‡πå</td>
                    <td>
                        <div class="status-buttons">
                            <div class="status-option" data-status="‚úÖ ‡∏°‡∏≤">‚úÖ ‡∏°‡∏≤</div>
                            <div class="status-option" data-status="‚ùå ‡∏Ç‡∏≤‡∏î">‚ùå ‡∏Ç‡∏≤‡∏î</div>
                            <div class="status-option" data-status="üìù ‡∏•‡∏≤">üìù ‡∏•‡∏≤</div>
                            <div class="status-option" data-status="‚è∞ ‡∏°‡∏≤‡∏™‡∏≤‡∏¢">‚è∞ ‡∏°‡∏≤‡∏™‡∏≤‡∏¢</div>
                        </div>
                    </td>
                </tr>
                <tr data-student-id="7">
                    <td>7</td>
                    <td>‡∏ô‡∏≤‡∏¢ ‡∏ß‡∏µ‡∏£‡∏ß‡∏¥‡∏ä‡∏ç‡πå ‡∏°‡∏∏‡πà‡∏á‡∏≠‡∏∏‡πà‡∏ô‡∏Å‡∏•‡∏≤‡∏á</td>
                    <td>
                        <div class="status-buttons">
                            <div class="status-option" data-status="‚úÖ ‡∏°‡∏≤">‚úÖ ‡∏°‡∏≤</div>
                            <div class="status-option" data-status="‚ùå ‡∏Ç‡∏≤‡∏î">‚ùå ‡∏Ç‡∏≤‡∏î</div>
                            <div class="status-option" data-status="üìù ‡∏•‡∏≤">üìù ‡∏•‡∏≤</div>
                            <div class="status-option" data-status="‚è∞ ‡∏°‡∏≤‡∏™‡∏≤‡∏¢">‚è∞ ‡∏°‡∏≤‡∏™‡∏≤‡∏¢</div>
                        </div>
                    </td>
                </tr>
                <tr data-student-id="8">
                    <td>8</td>
                    <td>‡∏ô‡∏≤‡∏¢ ‡∏ô‡∏±‡∏Å‡∏£‡∏ö ‡∏£‡∏±‡∏Å‡∏¢‡∏®‡πÑ‡∏ó‡∏¢</td>
                    <td>
                        <div class="status-buttons">
                            <div class="status-option" data-status="‚úÖ ‡∏°‡∏≤">‚úÖ ‡∏°‡∏≤</div>
                            <div class="status-option" data-status="‚ùå ‡∏Ç‡∏≤‡∏î">‚ùå ‡∏Ç‡∏≤‡∏î</div>
                            <div class="status-option" data-status="üìù ‡∏•‡∏≤">üìù ‡∏•‡∏≤</div>
                            <div class="status-option" data-status="‚è∞ ‡∏°‡∏≤‡∏™‡∏≤‡∏¢">‚è∞ ‡∏°‡∏≤‡∏™‡∏≤‡∏¢</div>
                        </div>
                    </td>
                </tr>
                <tr data-student-id="9">
                    <td>9</td>
                    <td>‡∏ô‡∏≤‡∏¢ ‡∏≠‡∏†‡∏¥‡∏ä‡∏±‡∏¢ ‡∏™‡∏µ‡∏´‡∏≤</td>
                    <td>
                        <div class="status-buttons">
                            <div class="status-option" data-status="‚úÖ ‡∏°‡∏≤">‚úÖ ‡∏°‡∏≤</div>
                            <div class="status-option" data-status="‚ùå ‡∏Ç‡∏≤‡∏î">‚ùå ‡∏Ç‡∏≤‡∏î</div>
                            <div class="status-option" data-status="üìù ‡∏•‡∏≤">üìù ‡∏•‡∏≤</div>
                            <div class="status-option" data-status="‚è∞ ‡∏°‡∏≤‡∏™‡∏≤‡∏¢">‚è∞ ‡∏°‡∏≤‡∏™‡∏≤‡∏¢</div>
                        </div>
                    </td>
                </tr>
                <tr data-student-id="10">
                    <td>10</td>
                    <td>‡∏ô‡∏≤‡∏á‡∏™‡∏≤‡∏ß ‡πÑ‡∏≠‡∏£‡∏¥‡∏ì ‡∏ñ‡∏ô‡∏≠‡∏°‡∏û‡∏•‡∏Å‡∏£‡∏±‡∏á</td>
                    <td>
                        <div class="status-buttons">
                            <div class="status-option" data-status="‚úÖ ‡∏°‡∏≤">‚úÖ ‡∏°‡∏≤</div>
                            <div class="status-option" data-status="‚ùå ‡∏Ç‡∏≤‡∏î">‚ùå ‡∏Ç‡∏≤‡∏î</div>
                            <div class="status-option" data-status="üìù ‡∏•‡∏≤">üìù ‡∏•‡∏≤</div>
                            <div class="status-option" data-status="‚è∞ ‡∏°‡∏≤‡∏™‡∏≤‡∏¢">‚è∞ ‡∏°‡∏≤‡∏™‡∏≤‡∏¢</div>
                        </div>
                    </td>
                </tr>
                <tr data-student-id="11">
                    <td>11</td>
                    <td>‡∏ô‡∏≤‡∏á‡∏™‡∏≤‡∏ß ‡∏†‡∏±‡∏ó‡∏£‡∏ß‡∏î‡∏µ ‡∏ä‡∏±‡∏¢‡∏ä‡∏ô‡∏∞</td>
                    <td>
                        <div class="status-buttons">
                            <div class="status-option" data-status="‚úÖ ‡∏°‡∏≤">‚úÖ ‡∏°‡∏≤</div>
                            <div class="status-option" data-status="‚ùå ‡∏Ç‡∏≤‡∏î">‚ùå ‡∏Ç‡∏≤‡∏î</div>
                            <div class="status-option" data-status="üìù ‡∏•‡∏≤">üìù ‡∏•‡∏≤</div>
                            <div class="status-option" data-status="‚è∞ ‡∏°‡∏≤‡∏™‡∏≤‡∏¢">‚è∞ ‡∏°‡∏≤‡∏™‡∏≤‡∏¢</div>
                        </div>
                    </td>
                </tr>
                <tr data-student-id="12">
                    <td>12</td>
                    <td>‡∏ô‡∏≤‡∏á‡∏™‡∏≤‡∏ß ‡∏ß‡∏£‡∏±‡∏ç‡∏ç‡∏≤ ‡∏ä‡∏∞‡πÇ‡∏•‡∏°‡∏Å‡∏•‡∏≤‡∏á</td>
                    <td>
                        <div class="status-buttons">
                            <div class="status-option" data-status="‚úÖ ‡∏°‡∏≤">‚úÖ ‡∏°‡∏≤</div>
                            <div class="status-option" data-status="‚ùå ‡∏Ç‡∏≤‡∏î">‚ùå ‡∏Ç‡∏≤‡∏î</div>
                            <div class="status-option" data-status="üìù ‡∏•‡∏≤">üìù ‡∏•‡∏≤</div>
                            <div class="status-option" data-status="‚è∞ ‡∏°‡∏≤‡∏™‡∏≤‡∏¢">‚è∞ ‡∏°‡∏≤‡∏™‡∏≤‡∏¢</div>
                        </div>
                    </td>
                </tr>
                <tr data-student-id="13">
                    <td>13</td>
                    <td>‡∏ô‡∏≤‡∏á‡∏™‡∏≤‡∏ß ‡∏ß‡∏¥‡∏•‡∏≤‡∏ß‡∏±‡∏ì‡∏¢‡πå ‡πÄ‡∏ß‡∏µ‡∏¢‡∏á‡∏•‡∏≠</td>
                    <td>
                        <div class="status-buttons">
                            <div class="status-option" data-status="‚úÖ ‡∏°‡∏≤">‚úÖ ‡∏°‡∏≤</div>
                            <div class="status-option" data-status="‚ùå ‡∏Ç‡∏≤‡∏î">‚ùå ‡∏Ç‡∏≤‡∏î</div>
                            <div class="status-option" data-status="üìù ‡∏•‡∏≤">üìù ‡∏•‡∏≤</div>
                            <div class="status-option" data-status="‚è∞ ‡∏°‡∏≤‡∏™‡∏≤‡∏¢">‚è∞ ‡∏°‡∏≤‡∏™‡∏≤‡∏¢</div>
                        </div>
                    </td>
                </tr>
                <tr data-student-id="14">
                    <td>14</td>
                    <td>‡∏ô‡∏≤‡∏á‡∏™‡∏≤‡∏ß ‡∏à‡∏∏‡∏¨‡∏≤‡∏£‡∏±‡∏ï‡∏ô‡πå ‡∏ô‡∏ß‡∏•‡∏≠‡∏ô‡∏±‡∏ô‡∏ï‡πå</td>
                    <td>
                        <div class="status-buttons">
                            <div class="status-option" data-status="‚úÖ ‡∏°‡∏≤">‚úÖ ‡∏°‡∏≤</div>
                            <div class="status-option" data-status="‚ùå ‡∏Ç‡∏≤‡∏î">‚ùå ‡∏Ç‡∏≤‡∏î</div>
                            <div class="status-option" data-status="üìù ‡∏•‡∏≤">üìù ‡∏•‡∏≤</div>
                            <div class="status-option" data-status="‚è∞ ‡∏°‡∏≤‡∏™‡∏≤‡∏¢">‚è∞ ‡∏°‡∏≤‡∏™‡∏≤‡∏¢</div>
                        </div>
                    </td>
                </tr>
                <tr data-student-id="15">
                    <td>15</td>
                    <td>‡∏ô‡∏≤‡∏á‡∏™‡∏≤‡∏ß ‡∏ü‡πâ‡∏≤‡πÉ‡∏™ ‡∏°‡∏µ‡∏ä‡∏±‡∏¢</td>
                    <td>
                        <div class="status-buttons">
                            <div class="status-option" data-status="‚úÖ ‡∏°‡∏≤">‚úÖ ‡∏°‡∏≤</div>
                            <div class="status-option" data-status="‚ùå ‡∏Ç‡∏≤‡∏î">‚ùå ‡∏Ç‡∏≤‡∏î</div>
                            <div class="status-option" data-status="üìù ‡∏•‡∏≤">üìù ‡∏•‡∏≤</div>
                            <div class="status-option" data-status="‚è∞ ‡∏°‡∏≤‡∏™‡∏≤‡∏¢">‚è∞ ‡∏°‡∏≤‡∏™‡∏≤‡∏¢</div>
                        </div>
                    </td>
                </tr>
                <tr data-student-id="16">
                    <td>16</td>
                    <td>‡∏ô‡∏≤‡∏á‡∏™‡∏≤‡∏ß ‡∏™‡∏¥‡∏£‡∏¥‡∏ô‡∏ó‡∏£‡∏≤ ‡πÉ‡∏à‡∏î‡∏µ</td>
                    <td>
                        <div class="status-buttons">
                            <div class="status-option" data-status="‚úÖ ‡∏°‡∏≤">‚úÖ ‡∏°‡∏≤</div>
                            <div class="status-option" data-status="‚ùå ‡∏Ç‡∏≤‡∏î">‚ùå ‡∏Ç‡∏≤‡∏î</div>
                            <div class="status-option" data-status="üìù ‡∏•‡∏≤">üìù ‡∏•‡∏≤</div>
                            <div class="status-option" data-status="‚è∞ ‡∏°‡∏≤‡∏™‡∏≤‡∏¢">‚è∞ ‡∏°‡∏≤‡∏™‡∏≤‡∏¢</div>
                        </div>
                    </td>
                </tr>
                <tr data-student-id="17">
                    <td>17</td>
                    <td>‡∏ô‡∏≤‡∏á‡∏™‡∏≤‡∏ß ‡∏Å‡∏≤‡∏ô‡∏ï‡πå‡∏ò‡∏¥‡∏î‡∏≤ ‡∏Å‡πà‡∏≠‡πÄ‡∏™‡∏•‡∏≤</td>
                    <td>
                        <div class="status-buttons">
                            <div class="status-option" data-status="‚úÖ ‡∏°‡∏≤">‚úÖ ‡∏°‡∏≤</div>
                            <div class="status-option" data-status="‚ùå ‡∏Ç‡∏≤‡∏î">‚ùå ‡∏Ç‡∏≤‡∏î</div>
                            <div class="status-option" data-status="üìù ‡∏•‡∏≤">üìù ‡∏•‡∏≤</div>
                            <div class="status-option" data-status="‚è∞ ‡∏°‡∏≤‡∏™‡∏≤‡∏¢">‚è∞ ‡∏°‡∏≤‡∏™‡∏≤‡∏¢</div>
                        </div>
                    </td>
                </tr>
                <tr data-student-id="18">
                    <td>18</td>
                    <td>‡∏ô‡∏≤‡∏á‡∏™‡∏≤‡∏ß ‡∏û‡∏∏‡∏í‡∏¥‡∏ò‡∏≤‡∏î‡∏≤ ‡∏ñ‡∏≤‡∏ß‡∏£</td>
                    <td>
                        <div class="status-buttons">
                            <div class="status-option" data-status="‚úÖ ‡∏°‡∏≤">‚úÖ ‡∏°‡∏≤</div>
                            <div class="status-option" data-status="‚ùå ‡∏Ç‡∏≤‡∏î">‚ùå ‡∏Ç‡∏≤‡∏î</div>
                            <div class="status-option" data-status="üìù ‡∏•‡∏≤">üìù ‡∏•‡∏≤</div>
                            <div class="status-option" data-status="‚è∞ ‡∏°‡∏≤‡∏™‡∏≤‡∏¢">‚è∞ ‡∏°‡∏≤‡∏™‡∏≤‡∏¢</div>
                        </div>
                    </td>
                </tr>
                <tr data-student-id="19">
                    <td>19</td>
                    <td>‡∏ô‡∏≤‡∏á‡∏™‡∏≤‡∏ß ‡∏ß‡∏ó‡∏±‡∏ô‡∏¢‡∏≤ ‡∏†‡∏π‡∏°‡∏¥‡∏ô‡∏≤‡∏á‡∏≤‡∏°</td>
                    <td>
                        <div class="status-buttons">
                            <div class="status-option" data-status="‚úÖ ‡∏°‡∏≤">‚úÖ ‡∏°‡∏≤</div>
                            <div class="status-option" data-status="‚ùå ‡∏Ç‡∏≤‡∏î">‚ùå ‡∏Ç‡∏≤‡∏î</div>
                            <div class="status-option" data-status="üìù ‡∏•‡∏≤">üìù ‡∏•‡∏≤</div>
                            <div class="status-option" data-status="‚è∞ ‡∏°‡∏≤‡∏™‡∏≤‡∏¢">‚è∞ ‡∏°‡∏≤‡∏™‡∏≤‡∏¢</div>
                        </div>
                    </td>
                </tr>
            </tbody>
        </table>
    </div>

    <div class="controls-bottom">
        <button onclick="exportTableToExcel()" class="button excel-button">üìÑ ‡∏™‡πà‡∏á‡∏≠‡∏≠‡∏Å Excel</button>
        <button onclick="saveToGoogleSheet()" class="button google-sheet-button">üì§ ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÑ‡∏õ‡∏¢‡∏±‡∏á Google Sheet</button>
    </div>
</div>

<script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
<script>
    document.addEventListener('DOMContentLoaded', () => {
        const rows = document.querySelectorAll("#attendanceTable tbody tr");
        rows.forEach(row => {
            const studentId = row.dataset.studentId;
            const statusButtons = row.querySelectorAll('.status-option');

            // Load status from localStorage for M.3/1 (using a distinct key)
            const savedStatus = localStorage.getItem(`status_M6_3_${studentId}`);
            if (savedStatus) {
                // Remove 'active' class and color classes from all buttons in the row
                statusButtons.forEach(btn => btn.classList.remove('active', 'status-‡∏°‡∏≤', 'status-‡∏Ç‡∏≤‡∏î', 'status-‡∏•‡∏≤', 'status-‡∏°‡∏≤‡∏™‡∏≤‡∏¢'));
                
                // Add 'active' class and color class to the button corresponding to the saved status
                const activeBtn = row.querySelector(`.status-option[data-status="${savedStatus}"]`);
                if (activeBtn) {
                    activeBtn.classList.add('active');
                    updateStatusButtonClass(activeBtn, savedStatus);
                }
            }

            // Add Event Listener to each status button in the row
            statusButtons.forEach(button => {
                button.addEventListener('click', (event) => {
                    const currentStatus = event.target.dataset.status;
                    const currentRow = event.target.closest('tr');
                    const currentStudentId = currentRow.dataset.studentId;

                    // Remove 'active' class and colors from all buttons in the same row
                    currentRow.querySelectorAll('.status-option').forEach(btn => {
                        btn.classList.remove('active', 'status-‡∏°‡∏≤', 'status-‡∏Ç‡∏≤‡∏î', 'status-‡∏•‡∏≤', 'status-‡∏°‡∏≤‡∏™‡∏≤‡∏¢');
                    });

                    // Add 'active' class and color to the selected button
                    event.target.classList.add('active');
                    updateStatusButtonClass(event.target, currentStatus);

                    // Save the current status to localStorage
                    localStorage.setItem(`status_M6_3_${currentStudentId}`, currentStatus);
                });
            });
        });

        // Instant search functionality for student names
        document.getElementById('searchInput').addEventListener('input', function() {
            const searchText = this.value.toLowerCase();
            const allRows = document.querySelectorAll("#attendanceTable tbody tr");

            allRows.forEach(row => {
                const name = row.querySelector("td:nth-child(2)").textContent.toLowerCase(); // Get student name from the second column
                if (name.includes(searchText)) {
                    row.style.display = ""; // Show row if name matches search text
                } else {
                    row.style.display = "none"; // Hide row otherwise
                }
            });
        });
    });

    // Helper function to apply appropriate CSS class based on status
    function updateStatusButtonClass(button, status) {
        // Remove all status-related classes first
        button.classList.remove('status-‡∏°‡∏≤', 'status-‡∏Ç‡∏≤‡∏î', 'status-‡∏•‡∏≤', 'status-‡∏°‡∏≤‡∏™‡∏≤‡∏¢');

        // Add the specific class based on the status
        switch (status) {
            case '‚úÖ ‡∏°‡∏≤':
                button.classList.add('status-‡∏°‡∏≤');
                break;
            case '‚ùå ‡∏Ç‡∏≤‡∏î':
                button.classList.add('status-‡∏Ç‡∏≤‡∏î');
                break;
            case 'üìù ‡∏•‡∏≤':
                button.classList.add('status-‡∏•‡∏≤');
                break;
            case '‚è∞ ‡∏°‡∏≤‡∏™‡∏≤‡∏¢':
                button.classList.add('status-‡∏°‡∏≤‡∏™‡∏≤‡∏¢');
                break;
        }
    }

    // Function to export attendance data to an Excel file
    function exportTableToExcel() {
        const table = document.querySelector("#attendanceTable");
        const rows = table.querySelectorAll("tbody tr");

        // Define header for the Excel file
        const data = [["‡∏•‡∏≥‡∏î‡∏±‡∏ö", "‡∏ä‡∏∑‡πà‡∏≠ - ‡∏™‡∏Å‡∏∏‡∏•", "‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞"]];

        // Iterate over each row to collect data
        rows.forEach(row => {
            const index = row.querySelector("td:nth-child(1)").textContent.trim(); // Student index
            const name = row.querySelector("td:nth-child(2)").textContent.trim(); // Student name
            // Get the text content of the active status button
            const activeStatusButton = row.querySelector(".status-option.active");
            const status = activeStatusButton ? activeStatusButton.dataset.status : ""; // Get status from data-status attribute

            data.push([index, name, status]); // Add row data to the array
        });

        // Create a new worksheet and workbook using XLSX library
        const worksheet = XLSX.utils.aoa_to_sheet(data);
        const workbook = XLSX.utils.book_new();
        XLSX.utils.book_append_sheet(workbook, worksheet, "‡πÄ‡∏ä‡πá‡∏Ñ‡∏ä‡∏∑‡πà‡∏≠ ‡∏°.6.3"); // Sheet name

        // Write the workbook to an Excel file
        XLSX.writeFile(workbook, "‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô‡πÄ‡∏ä‡πá‡∏Ñ‡∏ä‡∏∑‡πà‡∏≠ ‡∏°.6-3.xlsx"); // File name
    }

    // Function to save attendance data to a Google Sheet via Apps Script Web App
    async function saveToGoogleSheet() {
        // **Replace with the Web app URL you get from Apps Script Deploy for M.2/2**
        // This URL is specific to your Google Apps Script Web App for M.2/2
        const WEB_APP_URL = 'https://script.google.com/macros/s/AKfycbzAU1goYKbZdaPqXjLrQushyofLse1hXGZNFYG3RXqkDfnBDgygtK1MNnvAY6qiYzM8/exec'; // *** ‡πÇ‡∏õ‡∏£‡∏î‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô URL ‡∏ô‡∏µ‡πâ! ***

        const table = document.querySelector("#attendanceTable");
        const rows = table.querySelectorAll("tbody tr");

        const dataToSave = [];
        // Iterate over each row to collect data for saving
        rows.forEach(row => {
            const index = row.querySelector("td:nth-child(1)").textContent.trim();
            const name = row.querySelector("td:nth-child(2)").textContent.trim();
            
            // Read status from the 'active' button
            const activeStatusButton = row.querySelector(".status-option.active");
            const status = activeStatusButton ? activeStatusButton.dataset.status : "";
            
            dataToSave.push({ index, name, status }); // Prepare data object for each student
        });

        try {
            // Send data to Google Apps Script Web App
            const response = await fetch(WEB_APP_URL, {
                method: 'POST',
                mode: 'no-cors', // Important for Apps Script to avoid CORS (Cross-Origin Resource Sharing) error
                headers: {
                    'Content-Type': 'application/json',
                },
                body: JSON.stringify(dataToSave), // Convert data to JSON string
            });

            // Clear local storage for all students after successful save
            rows.forEach(row => {
                const studentId = row.dataset.studentId;
                localStorage.removeItem(`status_M6_3_${studentId}`); // Clear local storage for M.2/2
            });
            
            alert('‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÑ‡∏õ‡∏¢‡∏±‡∏á Google Sheet ‡∏°.6/3 ‡πÄ‡∏£‡∏µ‡∏¢‡∏ö‡∏£‡πâ‡∏≠‡∏¢‡πÅ‡∏•‡πâ‡∏ß!'); // User notification
            location.reload(); // Reload the page to reset attendance selections

        } catch (error) {
            console.error('‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•:', error); // Log error to console
            alert('‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•. ‡πÇ‡∏õ‡∏£‡∏î‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö Console ‡∏´‡∏£‡∏∑‡∏≠‡∏Å‡∏≤‡∏£‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤ Apps Script ‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì'); // User notification for error
        }
    }
</script>

</body>
</html>
```